set nocompatible
syntax on
filetype plugin indent on

" --------------------------------------------------------
" Auto install on the first time if there no plug.vim found
if empty(glob('~/.vim/autoload/plug.vim'))
    silent !curl -fLo ~/.vim/autoload/plug.vim --create-dirs
                \ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
    autocmd VimEnter * PlugInstall | source $MYVIMRC
endif
source ~/.vim/plugins.vim

let mapleader="\<SPACE>"

" Quickly open vimrc and apply change
nnoremap <Leader>ve :tabedit $MYVIMRC<CR>
nnoremap <Leader>vp :tabedit ~/.vim/plugins.vim<CR>
nnoremap <Leader>vi :tabedit ~/.vim/after/plugin/abbreviation.vim<CR>
nnoremap <Leader>vl :tabedit ~/.vimrc_local<CR>
nnoremap <Leader>va :so $MYVIMRC<CR>


" Auto remove trailing white space on saving file
" -----------------------------------------------
fun! <SID>StripTrailingWhitespaces()
    let l = line(".")
    let c = col(".")
    %s/\s\+$//e
    call cursor(l, c)
endfun
autocmd BufWritePre * :call <SID>StripTrailingWhitespaces()


" Use vimwiki as default, actually, I'm still not use vim heavily for other
" languages, not yet.
au BufEnter * if &ft == "" | setlocal ft=vimwiki | endif

" Custom theme
try
    colo lucius
    :LuciusDark
catch
endtry

" Delete comment character when joining comnmented lines
if v:version > 703 || v:version == 703 && has("patch541")
  set formatoptions+=j
endif

" Reload unchanged files automatically.
set autoread

map /  <Plug>(incsearch-forward)
map ?  <Plug>(incsearch-backward)
map g/ <Plug>(incsearch-stay)

" Date time inserting
"Tue 29 Mar 2016 09:07:43 AM ICT
:iab <expr> dtf strftime("%c")
:iab <expr> Dtf strftime("%c")
"2016-04-07
:iab <expr> dtd strftime("%Y-%m-%d")
:iab <expr> Dtd strftime("%Y-%m-%d")
"09:07:56
:iab <expr> dtt strftime("%T")
:iab <expr> Dtt strftime("%T")
" Need to make another variant that have first letter capitalized to use with
" the auto-capitalisation mode

" Save the file using Ctrl-S, this work in conjunction with disable Ctrl-S for
" Gnome temrinal
nmap <c-s> :w<CR>
imap <c-s> <Esc>:w<CR>a


" :W sudo saves the file
" " (useful for handling the permission-denied error)
command! SW w !sudo tee % > /dev/null

" Set lines to the cursor - when moving vertically using j/k
set so=5

" Use neocomplete.
let g:neocomplete#enable_at_startup = 1

" Load the local config
" This should always be at the end of the file
if !empty(glob("~/.vimrc_local"))
    source ~/.vimrc_local
endif

